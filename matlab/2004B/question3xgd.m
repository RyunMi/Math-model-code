clc,clear
o=ones(1,12);z=zeros(1,12);beq=ones(8,1);z1=zeros(8,1);
T=xlsread('question3','A1:L8');P=xlsread('question3','A10:L17');
xx=xlsread('question3','A19:H19');v=xlsread('question3','A20:H20');
T1=xx+15.*v;T2=xx-15.*v;
intcon=1:97;c=zeros(96,1);c=[c;1];
Aeq=[o,z,z,z,z,z,z,z,0;
   z,o,z,z,z,z,z,z,0;
   z,z,o,z,z,z,z,z,0;
   z,z,z,o,z,z,z,z,0;
   z,z,z,z,o,z,z,z,0;
   z,z,z,z,z,o,z,z,0;
   z,z,z,z,z,z,o,z,0;
   z,z,z,z,z,z,z,o,0];
A=[T(1,:),z,z,z,z,z,z,z,0;
     z,T(2,:),z,z,z,z,z,z,0;
     z,z,T(3,:),z,z,z,z,z,0;
     z,z,z,T(4,:),z,z,z,z,0;
     z,z,z,z,T(5,:),z,z,z,0;
     z,z,z,z,z,T(6,:),z,z,0;
     z,z,z,z,z,z,T(7,:),z,0;
     z,z,z,z,z,z,z,T(8,:),0;
     -T(1,:),z,z,z,z,z,z,z,0;
     z,-T(2,:),z,z,z,z,z,z,0;
     z,z,-T(3,:),z,z,z,z,z,0;
     z,z,z,-T(4,:),z,z,z,z,0;
     z,z,z,z,-T(5,:),z,z,z,0;
     z,z,z,z,z,-T(6,:),z,z,0;
     z,z,z,z,z,z,-T(7,:),z,0;
     z,z,z,z,z,z,z,-T(8,:),0;
     -T(1,:),-T(2,:),-T(3,:),-T(4,:),-T(5,:),-T(6,:),-T(7,:),-T(8,:),0;
     P(1,:),z,z,z,z,z,z,z,-1;
     z,P(2,:),z,z,z,z,z,z,-1;
     z,z,P(3,:),z,z,z,z,z,-1;
     z,z,z,P(4,:),z,z,z,z,-1;
     z,z,z,z,P(5,:),z,z,z,-1;
     z,z,z,z,z,P(6,:),z,z,-1;
     z,z,z,z,z,z,P(7,:),z,-1;
     z,z,z,z,z,z,z,P(8,:),-1;];
 b=[T1';-T2';-1052.8;z1];
 lb=zeros(97,1);ub=ones(96,1);ub=[ub;1000];
 [x,fval,exitflag]=intlinprog(c,intcon,A,b,Aeq,beq,lb,ub)
 X=['清算价格为：',num2str(x(97))];
 disp(X);x=x(1:96);x0=reshape(x,12,8)';[row,col]=find(x0~=0);